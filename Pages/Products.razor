@page "/products"
@using BlazorApp_PlatziCourse.Models;
@using BlazorApp_PlatziCourse.Services;
@inject ILogger<Products> logger;
@inject IProductService productService;

<PageTitle>Products</PageTitle>

<ModuleTitle title="Products" />

@if (productsList?.Count > 0)
{
	<div class="products-container">
		@foreach (var product in productsList)
		{
			<div class="card">
				<img class="card-img-top" src="@product?.Images?[0]" alt="Product" loading="lazy" width="270" height="210">
				<div class="card-body">
					<h4><b>@product?.Title</b></h4>
					<p>@product?.Price?.ToString("C")</p>
				</div>
			</div>
		}
	</div>
}
else
{
	<p>There are no products to display</p>
}

@code 
{
	private List<Product> productsList;

	protected override async Task OnInitializedAsync()
	{
		productsList = await GetProducts();
	}

	private async Task<List<Product>?> GetProducts()
	{
		return await productService.GetProducts();	
	}
}
